CLASS zamdp_04 DEFINITION
  PUBLIC
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
  INTERFACES IF_AMDP_MARKER_HDB.

  METHODS: CUSTOMER_LOAN EXPORTING VALUE(LT_LOAN) TYPE ZLOAN04_TT.

  PROTECTED SECTION.
  PRIVATE SECTION.
ENDCLASS.



CLASS zamdp_04 IMPLEMENTATION.

METHOD CUSTOMER_LOAN BY DATABASE PROCEDURE FOR HDB LANGUAGE SQLSCRIPT OPTIONS READ-ONLY USING ZLOAN04.

LT_LOAN = SELECT CUSTOMER_ID, LOAN_AMOUNT, DUE_DATE, LOAN_DATE,
          CASE PRIORITY
               WHEN 'H' THEN 'HIGH'
               WHEN 'L' THEN 'LOW'
               WHEN 'M' THEN 'MEDIUM'
         END AS PRIORITY,

         CASE
              WHEN DAYS_BETWEEN( DUE_DATE,LOAN_DATE ) BETWEEN 1 AND 30 THEN LOAN_AMOUNT *10/100
              WHEN DAYS_BETWEEN( DUE_DATE,LOAN_DATE ) BETWEEN 31 AND 90 THEN LOAN_AMOUNT *20/100
              ELSE LOAN_AMOUNT * 30/100
         END AS INTERST FROM ZLOAN04;

ENDMETHOD.
ENDCLASS.
